# 租户域名测试指南

## 域名工作原理

现在系统支持任意域名访问，后端通过 HTTP 请求的 Host 头来识别租户：

1. **用户设置 DNS**：将自己的域名指向你的服务器
2. **域名解析**：DNS 解析后，请求到达你的服务器
3. **租户识别**：后端根据请求的 Host 头查找对应的租户配置
4. **内容展示**：如果找到租户，显示租户页面；如果没找到，显示配置提示

## 本地测试配置

要在本地测试，请在 `/etc/hosts` 文件中添加：

```text
# 主域名（管理后台）
127.0.0.1 oli-cms.test

# 测试租户域名（可以是任意域名）
127.0.0.1 tenant1.oli-cms.test
127.0.0.1 company-abc.oli-cms.test
127.0.0.1 my-business.com
127.0.0.1 example.org
127.0.0.1 任意域名.test
```

## 架构优势

### 灵活的域名支持
- **任意域名**：用户可以使用自己的域名（如 company.com）
- **子域名支持**：也支持子域名（如 shop.company.com）
- **无需预配置**：不需要在服务器上预先配置域名规则

### 统一的 API 入口
- **路径区分**：`/api/*` → 后端，其他 → 前端
- **域名识别**：后端通过 Host 头识别租户
- **错误处理**：未配置的域名会显示友好的提示页面

## 测试步骤

### 1. 创建租户
1. 访问管理后台：<http://oli-cms.test/admin>
2. 登录并创建租户
3. 域名字段填写完整域名（如：`my-business.com`）

### 2. 配置域名解析
**本地测试**：在 hosts 文件添加 `127.0.0.1 my-business.com`
**生产环境**：设置 DNS A 记录指向服务器 IP

### 3. 访问测试
- 访问 `http://my-business.com` → 应该显示租户首页
- 访问 `http://unknown-domain.com` → 显示域名未配置提示

## 生产部署注意事项

1. **通配符域名**：可以使用通配符 SSL 证书支持任意子域名
2. **DNS 配置**：用户需要将域名的 A 记录指向你的服务器
3. **域名验证**：可以在租户创建时验证域名的 DNS 配置
4. **安全考虑**：可以添加域名白名单或黑名单机制

## 错误处理

系统会智能处理各种情况：
- **域名未配置**：显示配置提示和解决方案
- **租户已暂停**：显示相应状态信息
- **网络错误**：提供重试选项

这样的架构让用户可以真正使用自己的域名，同时保持系统的简洁性和可维护性。
